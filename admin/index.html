<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>لوحة التحكم - Technology KSA</title>
  <link rel="stylesheet" href="../assets/css/main.css">
  <link rel="stylesheet" href="../assets/css/rtl.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --saudi-green: #0C4A2F;
      --saudi-green-light: #10B981;
      --gold: #C5A572;
      --tech-blue: #0066FF;
      --bg-primary: #ffffff;
      --bg-secondary: #f8f9fa;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --border-color: #e5e7eb;
      --error: #ef4444;
      --success: #10B981;
      --warning: #f59e0b;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
      --radius-full: 9999px;
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    [data-theme="dark"] {
      --bg-primary: #1f2937;
      --bg-secondary: #111827;
      --text-primary: #f9fafb;
      --text-secondary: #9ca3af;
      --border-color: #374151;
    }

    body {
      font-family: 'Tajawal', sans-serif;
      background-color: var(--bg-secondary);
      color: var(--text-primary);
    }

    .admin-container {
      display: flex;
      min-height: 100vh;
    }

    .admin-sidebar {
      width: 280px;
      background-color: var(--bg-primary);
      box-shadow: var(--shadow-lg);
      position: fixed;
      right: 0;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      z-index: 50;
      display: flex;
      flex-direction: column;
    }

    .admin-logo {
      padding: 2rem;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
    }

    .admin-logo h2 {
      color: var(--saudi-green);
      margin-top: 1rem;
      font-size: 1.5rem;
    }

    .admin-nav {
      flex: 1;
      padding: 1.5rem 0;
    }

    .admin-nav ul {
      list-style: none;
    }

    .admin-nav li {
      margin-bottom: 0.5rem;
    }

    .admin-nav a {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.5rem;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s;
      border-right: 3px solid transparent;
    }

    .admin-nav li.active a,
    .admin-nav a:hover {
      background-color: var(--bg-secondary);
      color: var(--saudi-green);
      border-right-color: var(--saudi-green);
    }

    .admin-main {
      flex: 1;
      margin-right: 280px;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }

    .admin-header {
      background-color: var(--bg-primary);
      padding: 1.5rem 2rem;
      border-radius: var(--radius-xl);
      margin-bottom: 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow-md);
    }

    .admin-header h1 {
      margin: 0;
      font-size: 2rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 600;
      font-family: inherit;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background-color: var(--saudi-green);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--saudi-green-light);
    }

    .btn-secondary {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
    }

    .btn-danger {
      background-color: var(--error);
      color: white;
    }

    .admin-content {
      background-color: var(--bg-primary);
      padding: 2rem;
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-md);
    }

    .admin-view {
      display: none;
    }

    .admin-view.active {
      display: block;
    }

    /* Posts Table */
    .posts-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }

    .posts-table th,
    .posts-table td {
      padding: 1rem;
      text-align: right;
      border-bottom: 1px solid var(--border-color);
    }

    .posts-table th {
      background-color: var(--bg-secondary);
      font-weight: 600;
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: var(--radius-full);
      font-size: 0.875rem;
      font-weight: 600;
    }

    .badge-success {
      background-color: rgba(16, 185, 129, 0.1);
      color: var(--success);
    }

    .badge-warning {
      background-color: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }

    .action-buttons {
      display: flex;
      gap: 0.5rem;
    }

    .btn-icon {
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: var(--bg-secondary);
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-icon:hover {
      background-color: var(--saudi-green);
      color: white;
    }

    .btn-icon.btn-danger:hover {
      background-color: var(--error);
    }

    /* Media Library */
    .upload-area {
      border: 2px dashed var(--border-color);
      border-radius: var(--radius-xl);
      padding: 3rem;
      text-align: center;
      margin-bottom: 2rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    .upload-area:hover {
      border-color: var(--saudi-green);
      background-color: var(--bg-secondary);
    }

    .upload-area i {
      font-size: 4rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
    }

    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
    }

    .media-item {
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      background-color: var(--bg-secondary);
      border: 2px solid var(--border-color);
    }

    .media-item img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .media-item-info {
      padding: 0.75rem;
      background-color: var(--bg-primary);
    }

    .media-item-info input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 0.875rem;
      margin-top: 0.5rem;
      font-family: inherit;
      background-color: var(--bg-secondary);
      color: var(--text-primary);
    }

    .media-item-info small {
      display: block;
      color: var(--text-secondary);
      font-size: 0.75rem;
      margin-top: 0.25rem;
      word-break: break-all;
    }

    .media-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .media-actions button {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 600;
      transition: all 0.3s;
    }

    .media-actions .btn-select {
      background-color: var(--saudi-green);
      color: white;
    }

    .media-actions .btn-delete {
      background-color: var(--error);
      color: white;
    }

    /* Modal Styles - FIXED Z-INDEX */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 99999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal.active {
      display: flex;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 1;
    }

    .modal-content {
      position: relative;
      background-color: var(--bg-primary);
      border-radius: var(--radius-xl);
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-2xl);
      z-index: 10;
    }

    .modal-header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      background-color: var(--bg-primary);
      z-index: 20;
    }

    .modal-header h3 {
      margin: 0;
      font-size: 1.5rem;
    }

    .modal-close {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      border-radius: var(--radius-full);
      color: var(--text-secondary);
    }

    .modal-close:hover {
      background-color: var(--bg-secondary);
      color: var(--error);
    }

    .modal-body {
      padding: 2rem;
    }

    .modal-footer {
      padding: 1.5rem 2rem;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      position: sticky;
      bottom: 0;
      background-color: var(--bg-primary);
      z-index: 20;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      font-family: inherit;
      font-size: 1rem;
      color: var(--text-primary);
      background-color: var(--bg-secondary);
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--saudi-green);
    }

    .form-group textarea {
      min-height: 200px;
      resize: vertical;
    }

    .form-group small {
      display: block;
      margin-top: 0.25rem;
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    .featured-image-preview {
      margin-top: 1rem;
      padding: 1rem;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      background-color: var(--bg-secondary);
    }

    .featured-image-preview img {
      width: 100%;
      max-width: 400px;
      height: auto;
      border-radius: var(--radius-md);
      margin-bottom: 1rem;
    }

    .featured-image-preview .image-url {
      display: block;
      padding: 0.5rem;
      background-color: var(--bg-primary);
      border-radius: var(--radius-md);
      font-size: 0.875rem;
      color: var(--text-secondary);
      word-break: break-all;
      margin-bottom: 0.5rem;
    }

    .image-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-change-image,
    .btn-remove-image {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .btn-change-image {
      background-color: var(--saudi-green);
      color: white;
    }

    .btn-remove-image {
      background-color: var(--error);
      color: white;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 2rem;
      left: 2rem;
      background-color: var(--saudi-green);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      z-index: 999999;
      display: none;
      align-items: center;
      gap: 1rem;
      animation: slideIn 0.3s ease;
    }

    .toast.show {
      display: flex;
    }

    .toast.error {
      background-color: var(--error);
    }

    @keyframes slideIn {
      from {
        transform: translateX(-100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @media (max-width: 768px) {
      .admin-sidebar {
        transform: translateX(100%);
        transition: transform 0.3s;
      }

      .admin-sidebar.open {
        transform: translateX(0);
      }

      .admin-main {
        margin-right: 0;
      }
    }

    /* Settings Page Styles */
    .settings-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .settings-section-title {
      font-size: 1.75rem;
      margin-bottom: 2rem;
      color: var(--text-primary);
      font-weight: 700;
    }

    .settings-section {
      background: var(--bg-primary);
      padding: 2rem;
      border-radius: var(--radius-lg);
      margin-bottom: 2rem;
      box-shadow: var(--shadow-md);
    }

    .settings-heading {
      font-size: 1.25rem;
      margin-bottom: 1.5rem;
      color: var(--saudi-green);
      font-weight: 600;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid var(--border-color);
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .settings-grid .full-width {
      grid-column: 1 / -1;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .form-group label i {
      color: var(--saudi-green);
    }

    .form-input {
      padding: 0.875rem 1rem;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 1rem;
      font-family: inherit;
      transition: all 0.3s ease;
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--saudi-green);
      box-shadow: 0 0 0 3px rgba(12, 74, 47, 0.1);
    }

    .form-input::placeholder {
      color: var(--text-secondary);
      opacity: 0.7;
    }

    textarea.form-input {
      resize: vertical;
      min-height: 100px;
    }

    .settings-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 2px solid var(--border-color);
    }

    .btn-lg {
      padding: 1rem 2.5rem;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .btn-secondary {
      background: var(--text-secondary);
      color: white;
    }

    .btn-secondary:hover {
      background: var(--text-primary);
    }

    @media (max-width: 768px) {
      .settings-grid {
        grid-template-columns: 1fr;
      }

      .settings-actions {
        flex-direction: column;
      }

      .settings-actions .btn {
        width: 100%;
      }
    }

    /* Components Library Styles */
    .components-library {
      max-width: 1400px;
      margin: 0 auto;
    }

    .library-header {
      margin-bottom: 2rem;
    }

    .library-header h2 {
      font-size: 1.75rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .library-header p {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .component-tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      border-bottom: 2px solid var(--border-color);
      overflow-x: auto;
      padding-bottom: 0.5rem;
    }

    .component-tab {
      padding: 0.75rem 1.5rem;
      background: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      color: var(--text-secondary);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .component-tab:hover {
      color: var(--saudi-green);
    }

    .component-tab.active {
      color: var(--saudi-green);
      border-bottom-color: var(--saudi-green);
    }

    .component-tab-content {
      display: none;
    }

    .component-tab-content.active {
      display: block;
    }

    .component-actions {
      margin-bottom: 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .components-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 2rem;
    }

    .component-card {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      transition: all 0.3s ease;
      position: relative;
    }

    .component-card:hover {
      border-color: var(--saudi-green);
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    .component-card-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 1rem;
    }

    .component-card-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .component-card-type {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: rgba(12, 74, 47, 0.1);
      color: var(--saudi-green);
      border-radius: var(--radius-full);
      font-size: 0.875rem;
      font-weight: 600;
    }

    .component-card-preview {
      width: 100%;
      height: 180px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }

    .component-card-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .component-card-preview i {
      font-size: 3rem;
      color: var(--text-muted);
    }

    .component-card-description {
      color: var(--text-secondary);
      font-size: 0.95rem;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .component-card-actions {
      display: flex;
      gap: 0.5rem;
      justify-content: space-between;
    }

    .component-card-actions .btn {
      flex: 1;
      padding: 0.625rem 1rem;
      font-size: 0.9rem;
    }

    .component-empty {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-muted);
    }

    .component-empty i {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .component-empty h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: var(--text-secondary);
    }

    @media (max-width: 768px) {
      .components-grid {
        grid-template-columns: 1fr;
      }

      .component-tabs {
        gap: 0.25rem;
      }

      .component-tab {
        padding: 0.625rem 1rem;
        font-size: 0.9rem;
      }
    }

    /* ==========================================
       PAGE BUILDER STYLES
       ========================================== */

    .page-builder {
      max-width: 100%;
      height: 100%;
    }

    .builder-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid var(--border-color);
    }

    .builder-header h2 {
      font-size: 1.75rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .builder-header p {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .builder-actions {
      display: flex;
      gap: 1rem;
    }

    .builder-container {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 2rem;
      height: calc(100vh - 300px);
    }

    /* Sidebar with available components */
    .builder-sidebar {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      overflow-y: auto;
      max-height: 100%;
    }

    .sidebar-title {
      font-size: 1.25rem;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .component-categories {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .component-category {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 1rem;
    }

    .category-title {
      font-size: 1rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
    }

    .draggable-components {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .draggable-component {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 0.875rem;
      cursor: grab;
      transition: all 0.3s ease;
    }

    .draggable-component:hover {
      border-color: var(--saudi-green);
      box-shadow: var(--shadow-md);
      transform: translateX(-2px);
    }

    .draggable-component:active {
      cursor: grabbing;
    }

    .draggable-component h5 {
      font-size: 0.9rem;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
    }

    .draggable-component p {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin: 0;
    }

    /* Canvas area for building the page */
    .builder-canvas {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      overflow-y: auto;
      max-height: 100%;
    }

    .canvas-title {
      font-size: 1.25rem;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .page-canvas {
      min-height: 400px;
      background: var(--bg-secondary);
      border: 2px dashed var(--border-color);
      border-radius: var(--radius-lg);
      padding: 2rem;
    }

    .canvas-empty {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-muted);
    }

    .canvas-empty i {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .canvas-empty h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: var(--text-secondary);
    }

    .canvas-empty p {
      color: var(--text-muted);
    }

    /* Page section in canvas */
    .page-section {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
      position: relative;
    }

    .page-section:hover {
      border-color: var(--saudi-green);
      box-shadow: var(--shadow-md);
    }

    .page-section.dragging {
      opacity: 0.5;
      border-style: dashed;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }

    .section-info {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .section-icon {
      width: 40px;
      height: 40px;
      background: var(--saudi-green);
      color: white;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }

    .section-title-group h4 {
      font-size: 1rem;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
    }

    .section-title-group p {
      font-size: 0.875rem;
      color: var(--text-muted);
      margin: 0;
    }

    .section-actions {
      display: flex;
      gap: 0.5rem;
    }

    .section-actions .btn {
      padding: 0.5rem 0.75rem;
      font-size: 0.875rem;
    }

    .section-content {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 1rem;
    }

    .section-content-preview {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .section-content-preview strong {
      color: var(--text-primary);
      display: block;
      margin-bottom: 0.25rem;
    }

    /* Drag handle */
    .drag-handle {
      cursor: grab;
      color: var(--text-muted);
      padding: 0.25rem 0.5rem;
      margin-right: 0.5rem;
    }

    .drag-handle:active {
      cursor: grabbing;
    }

    /* Drop zone indicator */
    .drop-zone {
      border: 3px dashed var(--saudi-green);
      background: rgba(12, 74, 47, 0.1);
      padding: 2rem;
      border-radius: var(--radius-md);
      margin: 1rem 0;
      text-align: center;
      color: var(--saudi-green);
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .builder-container {
        grid-template-columns: 250px 1fr;
        gap: 1rem;
      }
    }

    @media (max-width: 768px) {
      .builder-header {
        flex-direction: column;
        gap: 1rem;
      }

      .builder-actions {
        width: 100%;
        flex-wrap: wrap;
      }

      .builder-actions .btn {
        flex: 1;
        min-width: 140px;
      }

      .builder-container {
        grid-template-columns: 1fr;
        gap: 1rem;
        height: auto;
      }

      .builder-sidebar {
        max-height: 300px;
      }
    }

    /* ==========================================
       DYNAMIC ITEMS (Features, Testimonials, Stats)
       ========================================== */

    .dynamic-item {
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 1rem;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }

    .dynamic-item:hover {
      border-color: var(--saudi-green);
      box-shadow: var(--shadow-sm);
    }

    .dynamic-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    .dynamic-item-header h6 {
      color: var(--text-primary);
      font-size: 0.95rem;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .dynamic-item-actions {
      display: flex;
      gap: 0.5rem;
    }

    .dynamic-item-actions button {
      padding: 0.25rem 0.5rem;
      font-size: 0.85rem;
    }

    .btn-sm {
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
    }

    .item-fields {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .item-fields .form-group {
      margin-bottom: 0;
    }

    .item-fields input,
    .item-fields textarea,
    .item-fields select {
      font-size: 0.9rem;
      padding: 0.625rem 0.875rem;
    }

    .item-fields label {
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="admin-logo">
        <i class="fas fa-code" style="font-size: 2.5rem; color: var(--saudi-green);"></i>
        <h2>لوحة التحكم</h2>
      </div>

      <nav class="admin-nav">
        <ul>
          <li class="active"><a href="#" data-view="posts"><i class="fas fa-file-alt"></i> المقالات</a></li>
          <li><a href="#" data-view="services"><i class="fas fa-briefcase"></i> الخدمات</a></li>
          <li><a href="#" data-view="projects"><i class="fas fa-folder-open"></i> المشاريع</a></li>
          <li><a href="#" data-view="pages"><i class="fas fa-file"></i> الصفحات</a></li>
          <li><a href="#" data-view="menus"><i class="fas fa-bars"></i> القوائم</a></li>
          <li><a href="#" data-view="media"><i class="fas fa-images"></i> مكتبة الصور</a></li>
          <li><a href="#" data-view="components"><i class="fas fa-cubes"></i> مكتبة العناصر</a></li>
          <li><a href="#" data-view="pagebuilder"><i class="fas fa-hammer"></i> Page Builder</a></li>
          <li><a href="#" data-view="settings"><i class="fas fa-cog"></i> الإعدادات</a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
      <div class="admin-header">
        <h1 id="pageTitle">إدارة المدونة</h1>
        <button class="btn btn-primary" id="btnNewPost">
          <i class="fas fa-plus"></i> <span id="btnNewText">إضافة مقال جديد</span>
        </button>
      </div>

      <div class="admin-content">
        <!-- Posts View -->
        <div id="postsView" class="admin-view active">
          <table class="posts-table" id="postsTable">
            <thead>
              <tr>
                <th>العنوان</th>
                <th>التصنيف</th>
                <th>التاريخ</th>
                <th>الحالة</th>
                <th>الإجراءات</th>
              </tr>
            </thead>
            <tbody id="postsTableBody">
              <!-- Posts will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Services View -->
        <div id="servicesView" class="admin-view">
          <table class="posts-table" id="servicesTable">
            <thead>
              <tr>
                <th>اسم الخدمة</th>
                <th>Slug</th>
                <th>الحالة</th>
                <th>الإجراءات</th>
              </tr>
            </thead>
            <tbody id="servicesTableBody">
              <!-- Services will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Projects View -->
        <div id="projectsView" class="admin-view">
          <table class="posts-table" id="projectsTable">
            <thead>
              <tr>
                <th>عنوان المشروع</th>
                <th>التصنيف</th>
                <th>العميل</th>
                <th>التاريخ</th>
                <th>الإجراءات</th>
              </tr>
            </thead>
            <tbody id="projectsTableBody">
              <!-- Projects will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Pages View -->
        <div id="pagesView" class="admin-view">
          <table class="posts-table" id="pagesTable">
            <thead>
              <tr>
                <th>عنوان الصفحة</th>
                <th>الرابط (Slug)</th>
                <th>عدد العناصر</th>
                <th>التاريخ</th>
                <th>الحالة</th>
                <th>الإجراءات</th>
              </tr>
            </thead>
            <tbody id="pagesTableBody">
              <!-- Pages will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Menus View -->
        <div id="menusView" class="admin-view">
          <table class="posts-table" id="menusTable">
            <thead>
              <tr>
                <th>اسم القائمة</th>
                <th>المعرف (ID)</th>
                <th>عدد العناصر</th>
                <th>الموقع</th>
                <th>التاريخ</th>
                <th>الإجراءات</th>
              </tr>
            </thead>
            <tbody id="menusTableBody">
              <!-- Menus will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Media View -->
        <div id="mediaView" class="admin-view">
          <div class="upload-area" id="uploadArea">
            <div class="upload-content">
              <i class="fas fa-cloud-upload-alt"></i>
              <h3>رفع الصور</h3>
              <p>اسحب وأفلت الصور هنا أو اضغط للاختيار</p>
              <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
              <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-upload"></i> اختر الصور
              </button>
            </div>
          </div>

          <div class="media-grid" id="mediaGrid">
            <!-- Media items will be inserted here -->
          </div>
        </div>

        <!-- Components Library View -->
        <div id="componentsView" class="admin-view">
          <div class="components-library">
            <div class="library-header">
              <h2>مكتبة العناصر</h2>
              <p>إنشاء وإدارة العناصر القابلة لإعادة الاستخدام في صفحات الموقع</p>
            </div>

            <!-- Component Types Tabs -->
            <div class="component-tabs">
              <button class="component-tab active" data-tab="hero">Hero Sections</button>
              <button class="component-tab" data-tab="cta">Call to Action</button>
              <button class="component-tab" data-tab="features">Features Grid</button>
              <button class="component-tab" data-tab="testimonials">Testimonials</button>
              <button class="component-tab" data-tab="stats">Statistics</button>
              <button class="component-tab" data-tab="contact">Contact Form</button>
              <button class="component-tab" data-tab="team">Team Members</button>
              <button class="component-tab" data-tab="pricing">Pricing Tables</button>
            </div>

            <!-- Hero Sections Tab -->
            <div class="component-tab-content active" data-content="hero">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('hero')">
                  <i class="fas fa-plus"></i> إضافة Hero Section جديد
                </button>
              </div>
              <div class="components-grid" id="heroComponentsGrid">
                <!-- Hero components will be loaded here -->
              </div>
            </div>

            <!-- CTA Sections Tab -->
            <div class="component-tab-content" data-content="cta">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('cta')">
                  <i class="fas fa-plus"></i> إضافة CTA Section جديد
                </button>
              </div>
              <div class="components-grid" id="ctaComponentsGrid">
                <!-- CTA components will be loaded here -->
              </div>
            </div>

            <!-- Features Grid Tab -->
            <div class="component-tab-content" data-content="features">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('features')">
                  <i class="fas fa-plus"></i> إضافة Features Grid جديد
                </button>
              </div>
              <div class="components-grid" id="featuresComponentsGrid">
                <!-- Features components will be loaded here -->
              </div>
            </div>

            <!-- Testimonials Tab -->
            <div class="component-tab-content" data-content="testimonials">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('testimonials')">
                  <i class="fas fa-plus"></i> إضافة Testimonials Section جديد
                </button>
              </div>
              <div class="components-grid" id="testimonialsComponentsGrid">
                <!-- Testimonials components will be loaded here -->
              </div>
            </div>

            <!-- Statistics Tab -->
            <div class="component-tab-content" data-content="stats">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('stats')">
                  <i class="fas fa-plus"></i> إضافة Statistics Section جديد
                </button>
              </div>
              <div class="components-grid" id="statsComponentsGrid">
                <!-- Stats components will be loaded here -->
              </div>
            </div>

            <!-- Contact Form Tab -->
            <div class="component-tab-content" data-content="contact">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('contact')">
                  <i class="fas fa-plus"></i> إضافة Contact Form جديد
                </button>
              </div>
              <div class="components-grid" id="contactComponentsGrid">
                <!-- Contact components will be loaded here -->
              </div>
            </div>

            <!-- Team Members Tab -->
            <div class="component-tab-content" data-content="team">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('team')">
                  <i class="fas fa-plus"></i> إضافة Team Section جديد
                </button>
              </div>
              <div class="components-grid" id="teamComponentsGrid">
                <!-- Team components will be loaded here -->
              </div>
            </div>

            <!-- Pricing Tables Tab -->
            <div class="component-tab-content" data-content="pricing">
              <div class="component-actions">
                <button class="btn btn-primary" onclick="openComponentModal('pricing')">
                  <i class="fas fa-plus"></i> إضافة Pricing Table جديد
                </button>
              </div>
              <div class="components-grid" id="pricingComponentsGrid">
                <!-- Pricing components will be loaded here -->
              </div>
            </div>
          </div>
        </div>

        <!-- Settings View -->
        <div id="settingsView" class="admin-view">
          <div class="settings-container">
            <h2 class="settings-section-title">إعدادات الموقع</h2>

            <!-- Site Information -->
            <div class="settings-section">
              <h3 class="settings-heading">معلومات الموقع</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="siteName">اسم الموقع (بالعربية)</label>
                  <input type="text" id="siteName" class="form-input" placeholder="تكنولوجيا السعودية">
                </div>
                <div class="form-group">
                  <label for="siteNameEn">اسم الموقع (بالإنجليزية)</label>
                  <input type="text" id="siteNameEn" class="form-input" placeholder="Technology KSA">
                </div>
                <div class="form-group full-width">
                  <label for="siteDescription">وصف الموقع</label>
                  <textarea id="siteDescription" class="form-input" rows="3" placeholder="شركة تكنولوجيا السعودية - وكالة رقمية رائدة..."></textarea>
                </div>
              </div>
            </div>

            <!-- Logo Settings -->
            <div class="settings-section">
              <h3 class="settings-heading">الشعار والصور</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="logoUrl">رابط الشعار (الافتراضي)</label>
                  <input type="text" id="logoUrl" class="form-input" placeholder="assets/images/logo.png">
                </div>
                <div class="form-group">
                  <label for="faviconUrl">رابط Favicon</label>
                  <input type="text" id="faviconUrl" class="form-input" placeholder="assets/images/favicon.ico">
                </div>
                <div class="form-group">
                  <label for="logoLight">شعار Light Mode</label>
                  <input type="text" id="logoLight" class="form-input" placeholder="assets/images/logo-light.png">
                  <small>الشعار الذي يظهر في الثيم الفاتح</small>
                </div>
                <div class="form-group">
                  <label for="logoDark">شعار Dark Mode</label>
                  <input type="text" id="logoDark" class="form-input" placeholder="assets/images/logo-dark.png">
                  <small>الشعار الذي يظهر في الثيم الداكن</small>
                </div>
              </div>
            </div>

            <!-- Header Settings -->
            <div class="settings-section">
              <h3 class="settings-heading">إعدادات الهيدر (Header)</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="headerTheme">ثيم الهيدر</label>
                  <select id="headerTheme" class="form-input">
                    <option value="light">Light (فاتح)</option>
                    <option value="dark">Dark (داكن)</option>
                    <option value="auto">Auto (تلقائي حسب الموقع)</option>
                  </select>
                  <small>اختر ثيم الهيدر الافتراضي</small>
                </div>
                <div class="form-group">
                  <label for="headerPosition">موقع الهيدر</label>
                  <select id="headerPosition" class="form-input">
                    <option value="static">Static (عادي)</option>
                    <option value="fixed">Fixed (ثابت عند التمرير)</option>
                    <option value="sticky">Sticky (يلتصق عند التمرير)</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="showSearch">إظهار البحث في الهيدر</label>
                  <select id="showSearch" class="form-input">
                    <option value="yes">نعم</option>
                    <option value="no">لا</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="showLanguageSwitcher">إظهار تبديل اللغة</label>
                  <select id="showLanguageSwitcher" class="form-input">
                    <option value="yes">نعم</option>
                    <option value="no">لا</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="headerCtaText">نص زر الحث في الهيدر</label>
                  <input type="text" id="headerCtaText" class="form-input" placeholder="احصل على استشارة">
                </div>
                <div class="form-group">
                  <label for="headerCtaLink">رابط زر الحث في الهيدر</label>
                  <input type="text" id="headerCtaLink" class="form-input" placeholder="#contact">
                </div>
              </div>
            </div>

            <!-- Footer Settings -->
            <div class="settings-section">
              <h3 class="settings-heading">إعدادات الفوتر (Footer)</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="footerLayout">تخطيط الفوتر</label>
                  <select id="footerLayout" class="form-input">
                    <option value="3-columns">3 أعمدة</option>
                    <option value="4-columns">4 أعمدة</option>
                    <option value="2-columns">عمودان</option>
                  </select>
                  <small>اختر عدد الأعمدة في الفوتر</small>
                </div>
                <div class="form-group">
                  <label for="showFooterCta">إظهار Call-to-Action في الفوتر</label>
                  <select id="showFooterCta" class="form-input">
                    <option value="yes">نعم</option>
                    <option value="no">لا</option>
                  </select>
                </div>
              </div>

              <div style="margin-top: 1.5rem;">
                <label style="display: block; margin-bottom: 1rem; font-weight: 600;">
                  <i class="fas fa-bars"></i> قوائم الفوتر
                </label>
                <div class="settings-grid">
                  <div class="form-group">
                    <label for="footerMenu1">قائمة العمود الأول</label>
                    <select id="footerMenu1" class="form-input">
                      <option value="">-- بدون قائمة --</option>
                      <!-- Menu options will be loaded dynamically -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="footerMenu2">قائمة العمود الثاني</label>
                    <select id="footerMenu2" class="form-input">
                      <option value="">-- بدون قائمة --</option>
                      <!-- Menu options will be loaded dynamically -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="footerMenu3">قائمة العمود الثالث</label>
                    <select id="footerMenu3" class="form-input">
                      <option value="">-- بدون قائمة --</option>
                      <!-- Menu options will be loaded dynamically -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="footerMenu4">قائمة العمود الرابع</label>
                    <select id="footerMenu4" class="form-input">
                      <option value="">-- بدون قائمة --</option>
                      <!-- Menu options will be loaded dynamically -->
                    </select>
                  </div>
                </div>
                <small style="display: block; margin-top: 0.5rem; color: var(--text-secondary);">
                  اختر القوائم التي تريد عرضها في كل عمود. يمكنك إنشاء القوائم من صفحة "القوائم".
                </small>
              </div>
            </div>

            <!-- Contact Information -->
            <div class="settings-section">
              <h3 class="settings-heading">معلومات التواصل</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="contactPhone">رقم الهاتف</label>
                  <input type="text" id="contactPhone" class="form-input" placeholder="+966 50 123 4567" dir="ltr">
                </div>
                <div class="form-group">
                  <label for="contactEmail">البريد الإلكتروني</label>
                  <input type="email" id="contactEmail" class="form-input" placeholder="info@technologyksa.com" dir="ltr">
                </div>
                <div class="form-group">
                  <label for="contactWhatsapp">رقم الواتساب</label>
                  <input type="text" id="contactWhatsapp" class="form-input" placeholder="+966501234567" dir="ltr">
                </div>
                <div class="form-group full-width">
                  <label for="contactAddress">العنوان</label>
                  <input type="text" id="contactAddress" class="form-input" placeholder="الرياض، المملكة العربية السعودية">
                </div>
              </div>
            </div>

            <!-- Social Media Links -->
            <div class="settings-section">
              <h3 class="settings-heading">روابط التواصل الاجتماعي</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="socialFacebook"><i class="fab fa-facebook"></i> Facebook</label>
                  <input type="url" id="socialFacebook" class="form-input" placeholder="https://facebook.com/..." dir="ltr">
                </div>
                <div class="form-group">
                  <label for="socialTwitter"><i class="fab fa-twitter"></i> Twitter / X</label>
                  <input type="url" id="socialTwitter" class="form-input" placeholder="https://twitter.com/..." dir="ltr">
                </div>
                <div class="form-group">
                  <label for="socialLinkedin"><i class="fab fa-linkedin"></i> LinkedIn</label>
                  <input type="url" id="socialLinkedin" class="form-input" placeholder="https://linkedin.com/..." dir="ltr">
                </div>
                <div class="form-group">
                  <label for="socialInstagram"><i class="fab fa-instagram"></i> Instagram</label>
                  <input type="url" id="socialInstagram" class="form-input" placeholder="https://instagram.com/..." dir="ltr">
                </div>
                <div class="form-group">
                  <label for="socialYoutube"><i class="fab fa-youtube"></i> YouTube</label>
                  <input type="url" id="socialYoutube" class="form-input" placeholder="https://youtube.com/..." dir="ltr">
                </div>
              </div>
            </div>

            <!-- Company Information -->
            <div class="settings-section">
              <h3 class="settings-heading">معلومات الشركة</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="companyYear">سنة التأسيس</label>
                  <input type="number" id="companyYear" class="form-input" placeholder="2010">
                </div>
                <div class="form-group">
                  <label for="companyCountry">البلد</label>
                  <input type="text" id="companyCountry" class="form-input" placeholder="المملكة العربية السعودية">
                </div>
                <div class="form-group full-width">
                  <label for="companyAbout">نبذة عن الشركة</label>
                  <textarea id="companyAbout" class="form-input" rows="4" placeholder="نحن شركة رائدة في تقديم الحلول التقنية المتكاملة..."></textarea>
                </div>
              </div>
            </div>

            <!-- Footer Settings -->
            <div class="settings-section">
              <h3 class="settings-heading">إعدادات التذييل</h3>
              <div class="settings-grid">
                <div class="form-group full-width">
                  <label for="footerCopyright">نص حقوق النشر</label>
                  <input type="text" id="footerCopyright" class="form-input" placeholder="© 2025 تكنولوجي السعودية. جميع الحقوق محفوظة.">
                </div>
              </div>
            </div>

            <!-- Layout Settings -->
            <div class="settings-section">
              <h3 class="settings-heading">إعدادات التخطيط والمظهر</h3>
              <div class="settings-grid">
                <div class="form-group">
                  <label for="headerStyle">نمط الهيدر (Header)</label>
                  <select id="headerStyle" class="form-input">
                    <option value="default">الافتراضي</option>
                    <option value="transparent">شفاف</option>
                    <option value="fixed">ثابت</option>
                    <option value="minimal">بسيط</option>
                  </select>
                  <small>نمط عرض الهيدر في جميع صفحات الموقع</small>
                </div>
                <div class="form-group">
                  <label for="headerColor">لون الهيدر</label>
                  <input type="color" id="headerColor" class="form-input" value="#0C4A2F">
                  <small>اللون الأساسي للهيدر</small>
                </div>
                <div class="form-group">
                  <label for="footerStyle">نمط الفوتر (Footer)</label>
                  <select id="footerStyle" class="form-input">
                    <option value="default">الافتراضي</option>
                    <option value="minimal">بسيط</option>
                    <option value="detailed">مفصّل</option>
                  </select>
                  <small>نمط عرض الفوتر في جميع الصفحات</small>
                </div>
                <div class="form-group">
                  <label for="footerColor">لون الفوتر</label>
                  <input type="color" id="footerColor" class="form-input" value="#0C4A2F">
                  <small>اللون الأساسي للفوتر</small>
                </div>
                <div class="form-group">
                  <label for="showBlogSidebar">عرض Sidebar في المدونة</label>
                  <select id="showBlogSidebar" class="form-input">
                    <option value="yes">نعم</option>
                    <option value="no">لا</option>
                  </select>
                  <small>هل تريد عرض الشريط الجانبي في صفحات المدونة؟</small>
                </div>
                <div class="form-group">
                  <label for="sidebarPosition">موقع Sidebar</label>
                  <select id="sidebarPosition" class="form-input">
                    <option value="right">يمين</option>
                    <option value="left">يسار</option>
                  </select>
                  <small>موقع الشريط الجانبي في المدونة</small>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="settings-actions">
              <button class="btn btn-primary btn-lg" onclick="saveSettings()">
                <i class="fas fa-save"></i> حفظ الإعدادات
              </button>
              <button class="btn btn-secondary btn-lg" onclick="resetSettings()">
                <i class="fas fa-undo"></i> استعادة الإعدادات الافتراضية
              </button>
            </div>
          </div>
        </div>

        <!-- Page Builder View -->
        <div id="pagebuilderView" class="admin-view">
          <div class="page-builder">
            <div class="builder-header">
              <div>
                <h2>Page Builder - <span id="currentPageName">بناء الصفحة</span></h2>
                <p>قم بتصميم الصفحة باستخدام السحب والإفلات أو الأزرار السريعة</p>
                <div style="margin-top: 0.5rem;">
                  <button class="btn btn-secondary btn-sm" onclick="selectPage()">
                    <i class="fas fa-exchange-alt"></i> اختيار صفحة
                  </button>
                  <button class="btn btn-primary btn-sm" onclick="addQuickElement('hero')">
                    <i class="fas fa-plus"></i> Hero
                  </button>
                  <button class="btn btn-primary btn-sm" onclick="addQuickElement('cta')">
                    <i class="fas fa-plus"></i> CTA
                  </button>
                  <button class="btn btn-primary btn-sm" onclick="addQuickElement('features')">
                    <i class="fas fa-plus"></i> Features
                  </button>
                  <button class="btn btn-primary btn-sm" onclick="addQuickElement('testimonials')">
                    <i class="fas fa-plus"></i> Testimonials
                  </button>
                  <button class="btn btn-primary btn-sm" onclick="addQuickElement('stats')">
                    <i class="fas fa-plus"></i> Stats
                  </button>
                </div>
              </div>
              <div class="builder-actions">
                <button class="btn btn-secondary" onclick="previewPage()">
                  <i class="fas fa-eye"></i> معاينة
                </button>
                <button class="btn btn-primary" onclick="savePageLayout()">
                  <i class="fas fa-save"></i> حفظ التخطيط
                </button>
                <button class="btn btn-success" onclick="publishPage()">
                  <i class="fas fa-globe"></i> نشر الصفحة
                </button>
              </div>
            </div>

            <div class="builder-container">
              <!-- Sidebar: Available Components -->
              <div class="builder-sidebar">
                <h3 class="sidebar-title">
                  <i class="fas fa-cubes"></i>
                  العناصر المتاحة
                </h3>

                <div class="component-categories">
                  <!-- Hero Sections -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-image"></i>
                      Hero Sections
                    </h4>
                    <div id="heroComponents" class="draggable-components"></div>
                  </div>

                  <!-- Call to Action -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-bullhorn"></i>
                      Call to Action
                    </h4>
                    <div id="ctaComponents" class="draggable-components"></div>
                  </div>

                  <!-- Features Grid -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-th"></i>
                      Features Grid
                    </h4>
                    <div id="featuresComponents" class="draggable-components"></div>
                  </div>

                  <!-- Testimonials -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-comments"></i>
                      Testimonials
                    </h4>
                    <div id="testimonialsComponents" class="draggable-components"></div>
                  </div>

                  <!-- Statistics -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-chart-bar"></i>
                      Statistics
                    </h4>
                    <div id="statsComponents" class="draggable-components"></div>
                  </div>

                  <!-- Contact Form -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-envelope"></i>
                      Contact Form
                    </h4>
                    <div id="contactComponents" class="draggable-components"></div>
                  </div>

                  <!-- Team Members -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-users"></i>
                      Team Members
                    </h4>
                    <div id="teamComponents" class="draggable-components"></div>
                  </div>

                  <!-- Pricing Tables -->
                  <div class="component-category">
                    <h4 class="category-title">
                      <i class="fas fa-tags"></i>
                      Pricing Tables
                    </h4>
                    <div id="pricingComponents" class="draggable-components"></div>
                  </div>
                </div>
              </div>

              <!-- Canvas: Page Layout -->
              <div class="builder-canvas">
                <h3 class="canvas-title">
                  <i class="fas fa-file-alt"></i>
                  تخطيط الصفحة
                </h3>
                <div id="pageCanvas" class="page-canvas">
                  <div class="canvas-empty">
                    <i class="fas fa-plus-circle"></i>
                    <h3>ابدأ بإضافة عناصر إلى الصفحة</h3>
                    <p>اسحب العناصر من الشريط الجانبي وأفلتها هنا</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Post Editor Modal -->
  <div id="postModal" class="modal">
    <div class="modal-overlay" onclick="closePostModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">إضافة مقال جديد</h3>
        <button class="modal-close" onclick="closePostModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="postForm">
          <input type="hidden" id="postId">

          <div class="form-group">
            <label for="postTitle">عنوان المقال <span style="color: var(--error);">*</span></label>
            <input type="text" id="postTitle" required placeholder="أدخل عنوان المقال">
            <small>سيتم توليد الـ slug والـ alt text تلقائياً من العنوان</small>
          </div>

          <div class="form-group">
            <label for="postSlug">Slug</label>
            <input type="text" id="postSlug" placeholder="سيتم التوليد تلقائياً">
            <small>رابط المقال (يتم توليده تلقائياً من العنوان)</small>
          </div>

          <div class="form-group">
            <label for="postCategory">التصنيف <span style="color: var(--error);">*</span></label>
            <select id="postCategory" required>
              <option value="">اختر التصنيف</option>
              <option value="تسويق رقمي">تسويق رقمي</option>
              <option value="تطوير ويب">تطوير ويب</option>
              <option value="تطبيقات جوال">تطبيقات جوال</option>
              <option value="أمن سيبراني">أمن سيبراني</option>
              <option value="تقنية">تقنية</option>
              <option value="استشارات">استشارات</option>
            </select>
          </div>

          <div class="form-group">
            <label>الصورة المميزة</label>
            <button type="button" class="btn btn-secondary" onclick="openImageSelector()">
              <i class="fas fa-image"></i> اختيار صورة من المكتبة
            </button>
            <div id="featuredImagePreview" style="display: none;" class="featured-image-preview">
              <img id="previewImage" src="" alt="">
              <small style="font-weight: 600; color: var(--text-primary); display: block; margin-bottom: 0.5rem;">رابط الصورة:</small>
              <span class="image-url" id="imageUrl"></span>
              <div class="form-group" style="margin-bottom: 0.5rem;">
                <label for="imageAlt">Alt Text للصورة</label>
                <input type="text" id="imageAlt" placeholder="وصف الصورة">
              </div>
              <div class="image-actions">
                <button type="button" class="btn-change-image" onclick="openImageSelector()">
                  <i class="fas fa-sync"></i> تغيير الصورة
                </button>
                <button type="button" class="btn-remove-image" onclick="removeFeaturedImage()">
                  <i class="fas fa-trash"></i> حذف الصورة
                </button>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="postExcerpt">المقتطف</label>
            <textarea id="postExcerpt" rows="3" placeholder="ملخص قصير للمقال"></textarea>
          </div>

          <div class="form-group">
            <label for="postContent">محتوى المقال <span style="color: var(--error);">*</span></label>
            <textarea id="postContent" required placeholder="اكتب محتوى المقال هنا..."></textarea>
          </div>

          <div class="form-group">
            <label for="metaTitle">عنوان Meta</label>
            <input type="text" id="metaTitle" placeholder="عنوان الصفحة للسيو">
          </div>

          <div class="form-group">
            <label for="metaDescription">وصف Meta</label>
            <textarea id="metaDescription" rows="2" placeholder="وصف الصفحة للسيو"></textarea>
          </div>

          <div class="form-group">
            <label for="postAuthor">الكاتب</label>
            <input type="text" id="postAuthor" value="فريق تكنولوجي السعودية" placeholder="اسم الكاتب">
          </div>

          <div class="form-group">
            <label for="postStatus">حالة المقال <span style="color: var(--error);">*</span></label>
            <select id="postStatus" required>
              <option value="published">منشور</option>
              <option value="draft">مسودة</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closePostModal()">إلغاء</button>
        <button type="button" class="btn btn-primary" onclick="savePost()">
          <i class="fas fa-save"></i> حفظ المقال
        </button>
      </div>
    </div>
  </div>

  <!-- Service Editor Modal -->
  <div id="serviceModal" class="modal">
    <div class="modal-overlay" onclick="closeServiceModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="serviceModalTitle">إضافة خدمة جديدة</h3>
        <button class="modal-close" onclick="closeServiceModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="serviceForm">
          <input type="hidden" id="serviceId">

          <div class="form-group">
            <label for="serviceName">اسم الخدمة <span style="color: var(--error);">*</span></label>
            <input type="text" id="serviceName" required placeholder="مثال: تطوير المواقع">
          </div>

          <div class="form-group">
            <label for="serviceSlug">Slug</label>
            <input type="text" id="serviceSlug" placeholder="web-development">
            <small>سيتم التوليد تلقائياً من الاسم</small>
          </div>

          <div class="form-group">
            <label for="serviceIcon">أيقونة Font Awesome</label>
            <input type="text" id="serviceIcon" placeholder="fas fa-code">
            <small>مثال: fas fa-code, fas fa-mobile-alt</small>
          </div>

          <div class="form-group">
            <label for="serviceDescription">الوصف المختصر <span style="color: var(--error);">*</span></label>
            <textarea id="serviceDescription" rows="3" required placeholder="وصف قصير عن الخدمة"></textarea>
          </div>

          <div class="form-group">
            <label for="serviceContent">المحتوى الكامل <span style="color: var(--error);">*</span></label>
            <textarea id="serviceContent" required placeholder="تفاصيل الخدمة الكاملة"></textarea>
          </div>

          <div class="form-group">
            <label>الصورة المميزة</label>
            <button type="button" class="btn btn-secondary" onclick="openImageSelectorForService()">
              <i class="fas fa-image"></i> اختيار صورة من المكتبة
            </button>
            <div id="serviceFeaturedImagePreview" style="display: none;" class="featured-image-preview">
              <img id="servicePreviewImage" src="" alt="">
              <div class="image-actions">
                <button type="button" class="btn-change-image" onclick="openImageSelectorForService()">
                  <i class="fas fa-sync"></i> تغيير الصورة
                </button>
                <button type="button" class="btn-remove-image" onclick="removeServiceFeaturedImage()">
                  <i class="fas fa-trash"></i> حذف الصورة
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeServiceModal()">إلغاء</button>
        <button type="button" class="btn btn-primary" onclick="saveService()">
          <i class="fas fa-save"></i> حفظ الخدمة
        </button>
      </div>
    </div>
  </div>

  <!-- Project Editor Modal -->
  <div id="projectModal" class="modal">
    <div class="modal-overlay" onclick="closeProjectModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="projectModalTitle">إضافة مشروع جديد</h3>
        <button class="modal-close" onclick="closeProjectModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="projectForm">
          <input type="hidden" id="projectId">

          <div class="form-group">
            <label for="projectTitle">عنوان المشروع <span style="color: var(--error);">*</span></label>
            <input type="text" id="projectTitle" required placeholder="مثال: منصة تجارة إلكترونية متكاملة">
          </div>

          <div class="form-group">
            <label for="projectSlug">Slug</label>
            <input type="text" id="projectSlug" placeholder="ecommerce-platform">
            <small>سيتم التوليد تلقائياً من العنوان</small>
          </div>

          <div class="form-group">
            <label for="projectCategory">التصنيف <span style="color: var(--error);">*</span></label>
            <select id="projectCategory" required>
              <option value="">اختر التصنيف</option>
              <option value="مواقع">مواقع إلكترونية</option>
              <option value="تطبيقات">تطبيقات جوال</option>
              <option value="هوية">هوية تجارية</option>
              <option value="تجارة">تجارة إلكترونية</option>
              <option value="تصميم">تصميم</option>
            </select>
          </div>

          <div class="form-group">
            <label for="projectDescription">الوصف المختصر <span style="color: var(--error);">*</span></label>
            <textarea id="projectDescription" rows="3" required placeholder="وصف مختصر عن المشروع"></textarea>
          </div>

          <div class="form-group">
            <label for="projectClient">اسم العميل</label>
            <input type="text" id="projectClient" placeholder="مثال: شركة التجارة الحديثة">
          </div>

          <div class="form-group">
            <label for="projectDate">تاريخ المشروع <span style="color: var(--error);">*</span></label>
            <input type="date" id="projectDate" required>
          </div>

          <div class="form-group">
            <label for="projectDuration">مدة التنفيذ</label>
            <input type="text" id="projectDuration" placeholder="مثال: 6 أشهر">
          </div>

          <div class="form-group">
            <label for="projectTags">التقنيات المستخدمة (افصل بفاصلة)</label>
            <input type="text" id="projectTags" placeholder="React, Node.js, MongoDB">
            <small>افصل التقنيات بفاصلة</small>
          </div>

          <div class="form-group">
            <label>صورة المشروع</label>
            <button type="button" class="btn btn-secondary" onclick="openImageSelectorForProject()">
              <i class="fas fa-image"></i> اختيار صورة من المكتبة
            </button>
            <div id="projectFeaturedImagePreview" style="display: none;" class="featured-image-preview">
              <img id="projectPreviewImage" src="" alt="">
              <div class="image-actions">
                <button type="button" class="btn-change-image" onclick="openImageSelectorForProject()">
                  <i class="fas fa-sync"></i> تغيير الصورة
                </button>
                <button type="button" class="btn-remove-image" onclick="removeProjectFeaturedImage()">
                  <i class="fas fa-trash"></i> حذف الصورة
                </button>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="projectContent">تفاصيل المشروع الكاملة</label>
            <textarea id="projectContent" rows="5" placeholder="اكتب تفاصيل المشروع والتحديات والحلول..."></textarea>
          </div>

          <div class="form-group">
            <label for="projectFeatures">المميزات الرئيسية (واحدة في كل سطر)</label>
            <textarea id="projectFeatures" rows="5" placeholder="واجهة مستخدم حديثة&#10;نظام إدارة متقدم&#10;تكامل مع بوابات الدفع"></textarea>
            <small>اكتب كل ميزة في سطر منفصل</small>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeProjectModal()">إلغاء</button>
        <button type="button" class="btn btn-primary" onclick="saveProject()">
          <i class="fas fa-save"></i> حفظ المشروع
        </button>
      </div>
    </div>
  </div>

  <!-- Image Selector Modal -->
  <div id="imageSelectorModal" class="modal">
    <div class="modal-overlay" onclick="closeImageSelector()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>اختيار صورة</h3>
        <button class="modal-close" onclick="closeImageSelector()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="media-grid" id="imageSelectorGrid">
          <!-- Images will be inserted here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Page Editor Modal -->
  <div id="pageModal" class="modal">
    <div class="modal-overlay" onclick="closePageModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="pageModalTitle">إضافة صفحة جديدة</h3>
        <button class="modal-close" onclick="closePageModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="pageForm" onsubmit="savePage(event)">
          <input type="hidden" id="pageId">

          <div class="form-group">
            <label for="pageTitle">عنوان الصفحة <span style="color: var(--error);">*</span></label>
            <input type="text" id="pageTitle" required placeholder="عن الشركة">
            <small>سيتم توليد الرابط (slug) تلقائياً من العنوان</small>
          </div>

          <div class="form-group">
            <label for="pageSlug">رابط الصفحة (Slug)</label>
            <input type="text" id="pageSlug" placeholder="about-us">
            <small>الرابط الذي سيظهر في المتصفح (مثل: example.com/about-us)</small>
          </div>

          <div class="form-group">
            <label for="pageMetaTitle">عنوان SEO (Meta Title)</label>
            <input type="text" id="pageMetaTitle" placeholder="عن شركة تكنولوجيا السعودية">
            <small>العنوان الذي يظهر في نتائج البحث</small>
          </div>

          <div class="form-group">
            <label for="pageMetaDescription">وصف SEO (Meta Description)</label>
            <textarea id="pageMetaDescription" rows="3" placeholder="تعرف على شركتنا وخدماتنا..."></textarea>
            <small>الوصف الذي يظهر في نتائج البحث</small>
          </div>

          <div class="form-group">
            <label for="pageStatus">حالة الصفحة</label>
            <select id="pageStatus">
              <option value="published">منشورة</option>
              <option value="draft">مسودة</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> حفظ الصفحة
            </button>
            <button type="button" class="btn btn-secondary" onclick="openPageBuilder()">
              <i class="fas fa-hammer"></i> فتح Page Builder
            </button>
            <button type="button" class="btn btn-secondary" onclick="closePageModal()">
              <i class="fas fa-times"></i> إلغاء
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Menu Editor Modal -->
  <div id="menuModal" class="modal">
    <div class="modal-overlay" onclick="closeMenuModal()"></div>
    <div class="modal-content" style="max-width: 800px;">
      <div class="modal-header">
        <h3 id="menuModalTitle">إضافة قائمة جديدة</h3>
        <button class="modal-close" onclick="closeMenuModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="menuForm" onsubmit="saveMenu(event)">
          <input type="hidden" id="menuId">

          <div class="form-group">
            <label for="menuName">اسم القائمة <span style="color: var(--error);">*</span></label>
            <input type="text" id="menuName" required placeholder="القائمة الرئيسية">
            <small>اسم تعريفي للقائمة لاستخدامها في لوحة التحكم</small>
          </div>

          <div class="form-group">
            <label for="menuLocation">موقع القائمة</label>
            <select id="menuLocation">
              <option value="header">Header (الهيدر)</option>
              <option value="footer-1">Footer Column 1 (عمود 1)</option>
              <option value="footer-2">Footer Column 2 (عمود 2)</option>
              <option value="footer-3">Footer Column 3 (عمود 3)</option>
              <option value="sidebar">Sidebar (الشريط الجانبي)</option>
              <option value="custom">مخصص (Custom)</option>
            </select>
          </div>

          <div class="form-group">
            <label style="display: block; margin-bottom: 1rem; font-weight: 600;">
              <i class="fas fa-list"></i> عناصر القائمة
            </label>

            <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">
                  اختر الصفحات التي تريد إضافتها للقائمة:
                </p>
                <button type="button" class="btn btn-primary btn-sm" onclick="openQuickPageModal()">
                  <i class="fas fa-plus"></i> إضافة صفحة جديدة
                </button>
              </div>
              <div id="availablePages" style="display: grid; gap: 0.5rem;">
                <!-- Available pages will be inserted here as checkboxes -->
              </div>
            </div>

            <div style="margin-top: 1rem;">
              <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                إضافة رابط مخصص:
              </label>
              <div style="display: grid; grid-template-columns: 2fr 2fr 1fr; gap: 0.5rem;">
                <input type="text" id="customItemTitle" class="form-input" placeholder="العنوان">
                <input type="text" id="customItemUrl" class="form-input" placeholder="الرابط">
                <button type="button" class="btn btn-secondary" onclick="addCustomMenuItem()">
                  <i class="fas fa-plus"></i> إضافة
                </button>
              </div>
            </div>

            <div style="margin-top: 1.5rem;">
              <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                <i class="fas fa-sort"></i> ترتيب عناصر القائمة:
              </label>
              <div id="menuItemsList" style="display: flex; flex-direction: column; gap: 0.5rem;">
                <!-- Selected menu items will appear here -->
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> حفظ القائمة
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeMenuModal()">
              <i class="fas fa-times"></i> إلغاء
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Section Editor Modal (Page Builder) -->
  <div id="sectionEditorModal" class="modal">
    <div class="modal-overlay" onclick="closeSectionEditor()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="sectionModalTitle">تحرير العنصر</h3>
        <button class="modal-close" onclick="closeSectionEditor()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="sectionForm" onsubmit="saveSectionEdit(event)">
          <input type="hidden" id="sectionIndex">
          <input type="hidden" id="sectionType">

          <div class="form-group">
            <label for="sectionTitle">عنوان العنصر <span style="color: var(--error);">*</span></label>
            <input type="text" id="sectionTitle" required placeholder="أدخل عنوان العنصر">
          </div>

          <div class="form-group">
            <label for="sectionDescription">وصف العنصر</label>
            <textarea id="sectionDescription" rows="2" placeholder="وصف مختصر للعنصر"></textarea>
          </div>

          <!-- Hero Section Fields -->
          <div id="heroFields" class="section-fields" style="display: none;">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
              <i class="fas fa-image"></i> محتوى Hero Section
            </h4>
            <div class="form-group">
              <label for="heroTitle">العنوان الرئيسي <span style="color: var(--error);">*</span></label>
              <input type="text" id="heroTitle" placeholder="عنوان جذاب يظهر في الأعلى">
            </div>
            <div class="form-group">
              <label for="heroSubtitle">النص الفرعي</label>
              <textarea id="heroSubtitle" rows="3" placeholder="نص يوضح الخدمة أو المنتج"></textarea>
            </div>
            <div class="form-group">
              <label for="heroButtonText">نص الزر</label>
              <input type="text" id="heroButtonText" placeholder="ابدأ الآن">
            </div>
            <div class="form-group">
              <label for="heroButtonLink">رابط الزر</label>
              <input type="text" id="heroButtonLink" placeholder="#contact">
            </div>
            <div class="form-group">
              <label for="heroBackgroundImage">رابط صورة الخلفية</label>
              <input type="text" id="heroBackgroundImage" placeholder="https://...">
            </div>
            <div class="form-group">
              <label for="heroBackgroundColor">لون/تدرج الخلفية</label>
              <input type="text" id="heroBackgroundColor" placeholder="linear-gradient(135deg, #0C4A2F 0%, #10B981 100%)">
              <small>يمكنك استخدام لون أو gradient CSS</small>
            </div>
          </div>

          <!-- CTA Fields -->
          <div id="ctaFields" class="section-fields" style="display: none;">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
              <i class="fas fa-bullhorn"></i> محتوى Call to Action
            </h4>
            <div class="form-group">
              <label for="ctaTitle">العنوان <span style="color: var(--error);">*</span></label>
              <input type="text" id="ctaTitle" placeholder="هل لديك مشروع؟">
            </div>
            <div class="form-group">
              <label for="ctaDescription">الوصف</label>
              <textarea id="ctaDescription" rows="3" placeholder="تواصل معنا الآن واحصل على استشارة مجانية"></textarea>
            </div>
            <div class="form-group">
              <label for="ctaButtonText">نص الزر <span style="color: var(--error);">*</span></label>
              <input type="text" id="ctaButtonText" placeholder="تواصل معنا">
            </div>
            <div class="form-group">
              <label for="ctaButtonLink">رابط الزر</label>
              <input type="text" id="ctaButtonLink" placeholder="#contact">
            </div>
          </div>

          <!-- Features Fields -->
          <div id="featuresFields" class="section-fields" style="display: none;">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
              <i class="fas fa-th"></i> محتوى Features Grid
            </h4>

            <div class="form-group">
              <label for="featuresTitle">عنوان القسم</label>
              <input type="text" id="featuresTitle" placeholder="خدماتنا المميزة">
            </div>

            <div class="form-group">
              <label for="featuresSubtitle">نص فرعي</label>
              <textarea id="featuresSubtitle" rows="2" placeholder="نقدم مجموعة متكاملة من الخدمات"></textarea>
            </div>

            <div style="margin-top: 1.5rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h5 style="color: var(--text-primary); margin: 0;">الميزات</h5>
                <button type="button" class="btn btn-primary btn-sm" onclick="addFeatureItem()">
                  <i class="fas fa-plus"></i> إضافة ميزة
                </button>
              </div>
              <div id="featuresList"></div>
            </div>
          </div>

          <!-- Testimonials Fields -->
          <div id="testimonialsFields" class="section-fields" style="display: none;">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
              <i class="fas fa-comments"></i> محتوى Testimonials
            </h4>

            <div class="form-group">
              <label for="testimonialsTitle">عنوان القسم</label>
              <input type="text" id="testimonialsTitle" placeholder="آراء عملائنا">
            </div>

            <div class="form-group">
              <label for="testimonialsSubtitle">نص فرعي</label>
              <textarea id="testimonialsSubtitle" rows="2" placeholder="ماذا يقول عملاؤنا عنا"></textarea>
            </div>

            <div style="margin-top: 1.5rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h5 style="color: var(--text-primary); margin: 0;">الشهادات</h5>
                <button type="button" class="btn btn-primary btn-sm" onclick="addTestimonialItem()">
                  <i class="fas fa-plus"></i> إضافة شهادة
                </button>
              </div>
              <div id="testimonialsList"></div>
            </div>
          </div>

          <!-- Statistics Fields -->
          <div id="statsFields" class="section-fields" style="display: none;">
            <h4 style="color: var(--text-primary); margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
              <i class="fas fa-chart-bar"></i> محتوى Statistics
            </h4>

            <div class="form-group">
              <label for="statsTitle">عنوان القسم</label>
              <input type="text" id="statsTitle" placeholder="إنجازاتنا بالأرقام">
            </div>

            <div class="form-group">
              <label for="statsSubtitle">نص فرعي</label>
              <textarea id="statsSubtitle" rows="2" placeholder="أرقام تتحدث عن خبرتنا"></textarea>
            </div>

            <div style="margin-top: 1.5rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h5 style="color: var(--text-primary); margin: 0;">الإحصائيات</h5>
                <button type="button" class="btn btn-primary btn-sm" onclick="addStatItem()">
                  <i class="fas fa-plus"></i> إضافة إحصائية
                </button>
              </div>
              <div id="statsList"></div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> حفظ التعديلات
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeSectionEditor()">
              <i class="fas fa-times"></i> إلغاء
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage"></span>
  </div>

  <script src="../assets/js/admin.js"></script>
  <script>
    // Initialize Admin Panel
    let blogCMS;
    let currentImageTarget = 'post'; // 'post' or 'service'

    document.addEventListener('DOMContentLoaded', function() {
      blogCMS = new BlogCMS();
      blogCMS.init();

      // Initialize Pages Manager
      pagesManager = new PagesManager();
      pagesManager.init();

      // Navigation
      document.querySelectorAll('.admin-nav a').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const view = this.dataset.view;

          // Update active nav
          document.querySelectorAll('.admin-nav li').forEach(li => li.classList.remove('active'));
          this.parentElement.classList.add('active');

          // Show view
          document.querySelectorAll('.admin-view').forEach(v => v.classList.remove('active'));
          document.getElementById(view + 'View').classList.add('active');

          // Update header
          const pageTitle = document.getElementById('pageTitle');
          const btnNewPost = document.getElementById('btnNewPost');
          const btnNewText = document.getElementById('btnNewText');

          if (view === 'posts') {
            pageTitle.textContent = 'إدارة المدونة';
            btnNewText.textContent = 'إضافة مقال جديد';
            btnNewPost.onclick = openPostModal;
          } else if (view === 'services') {
            pageTitle.textContent = 'إدارة الخدمات';
            btnNewText.textContent = 'إضافة خدمة جديدة';
            btnNewPost.onclick = openServiceModal;
          } else if (view === 'projects') {
            pageTitle.textContent = 'إدارة المشاريع';
            btnNewText.textContent = 'إضافة مشروع جديد';
            btnNewPost.onclick = openProjectModal;
          } else if (view === 'pages') {
            pageTitle.textContent = 'إدارة الصفحات';
            btnNewText.textContent = 'إضافة صفحة جديدة';
            btnNewPost.onclick = openPageModal;
            pagesManager.renderPagesList();
          } else if (view === 'menus') {
            pageTitle.textContent = 'إدارة القوائم';
            btnNewText.textContent = 'إضافة قائمة جديدة';
            btnNewPost.onclick = openMenuModal;
            if (menusManager) menusManager.renderMenusList();
          } else if (view === 'media') {
            pageTitle.textContent = 'مكتبة الصور';
            btnNewPost.style.display = 'none';
          } else if (view === 'settings') {
            pageTitle.textContent = 'إعدادات الموقع';
            btnNewPost.style.display = 'none';
            // Load settings when opening settings page
            loadSettings();
          } else if (view === 'components') {
            pageTitle.textContent = 'مكتبة العناصر';
            btnNewPost.style.display = 'none';
            initComponentsLibrary();
          } else if (view === 'pagebuilder') {
            pageTitle.textContent = 'Page Builder';
            btnNewPost.style.display = 'none';
            initPageBuilder();
          }

          if (view !== 'media' && view !== 'settings' && view !== 'components' && view !== 'pagebuilder') {
            btnNewPost.style.display = 'flex';
          }

          // Initialize pages manager when needed
          if (view === 'pages' && !pagesManager) {
            pagesManager = new PagesManager();
            pagesManager.init();
          }

          // Initialize menus manager when needed
          if (view === 'menus' && !menusManager) {
            menusManager = new MenusManager();
            menusManager.init();
          }
        });
      });

      // New Post Button
      document.getElementById('btnNewPost').addEventListener('click', function() {
        openPostModal();
      });

      // File Upload
      const fileInput = document.getElementById('fileInput');
      const uploadArea = document.getElementById('uploadArea');

      fileInput.addEventListener('change', function(e) {
        handleFiles(e.target.files);
      });

      uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });

      uploadArea.addEventListener('dragleave', function() {
        uploadArea.classList.remove('dragover');
      });

      uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        handleFiles(e.dataTransfer.files);
      });

      // Auto-generate slug from title (posts)
      document.getElementById('postTitle').addEventListener('input', function() {
        const title = this.value;
        const slug = blogCMS.generateSlug(title);
        document.getElementById('postSlug').value = slug;

        if (!document.getElementById('imageAlt').value) {
          document.getElementById('imageAlt').value = title;
        }
      });

      // Auto-generate slug from service name
      document.getElementById('serviceName').addEventListener('input', function() {
        const name = this.value;
        const slug = blogCMS.generateSlug(name);
        document.getElementById('serviceSlug').value = slug;
      });

      // Auto-generate slug from project title
      document.getElementById('projectTitle').addEventListener('input', function() {
        const title = this.value;
        const slug = blogCMS.generateSlug(title);
        document.getElementById('projectSlug').value = slug;
      });
    });

    function handleFiles(files) {
      Array.from(files).forEach(file => {
        if (file.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = function(e) {
            blogCMS.uploadImage(file.name, e.target.result);
          };
          reader.readAsDataURL(file);
        }
      });
    }

    // === POST FUNCTIONS ===
    function openPostModal(postId = null) {
      const modal = document.getElementById('postModal');
      const form = document.getElementById('postForm');
      form.reset();

      if (postId) {
        const post = blogCMS.posts.find(p => p.id === postId);
        if (post) {
          document.getElementById('modalTitle').textContent = 'تعديل المقال';
          document.getElementById('postId').value = post.id;
          document.getElementById('postTitle').value = post.title;
          document.getElementById('postSlug').value = post.slug;
          document.getElementById('postCategory').value = post.category;
          document.getElementById('postExcerpt').value = post.excerpt;
          document.getElementById('postContent').value = post.content;
          document.getElementById('metaTitle').value = post.metaTitle;
          document.getElementById('metaDescription').value = post.metaDescription;
          document.getElementById('postAuthor').value = post.author;
          document.getElementById('postStatus').value = post.status;

          if (post.featuredImage) {
            showImagePreview(post.featuredImage, post.imageAlt || post.title);
          }
        }
      } else {
        document.getElementById('modalTitle').textContent = 'إضافة مقال جديد';
        document.getElementById('featuredImagePreview').style.display = 'none';
      }

      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closePostModal() {
      const modal = document.getElementById('postModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }

    function openImageSelector() {
      currentImageTarget = 'post';
      const modal = document.getElementById('imageSelectorModal');
      const grid = document.getElementById('imageSelectorGrid');

      grid.innerHTML = '';

      blogCMS.media.forEach(item => {
        const div = document.createElement('div');
        div.className = 'media-item';
        div.innerHTML = `
          <img src="${item.url}" alt="${item.alt || item.name}">
          <div class="media-item-info">
            <button class="btn btn-primary" style="width: 100%;" onclick="selectImage('${item.id}')">
              <i class="fas fa-check"></i> اختيار
            </button>
          </div>
        `;
        grid.appendChild(div);
      });

      modal.classList.add('active');
    }

    function closeImageSelector() {
      const modal = document.getElementById('imageSelectorModal');
      modal.classList.remove('active');
    }

    function selectImage(imageId) {
      const image = blogCMS.media.find(m => m.id === imageId);
      if (image) {
        if (currentImageTarget === 'post') {
          const postTitle = document.getElementById('postTitle').value || 'صورة المقال';
          showImagePreview(image.url, image.alt || postTitle);
        } else if (currentImageTarget === 'service') {
          showServiceImagePreview(image.url);
        } else if (currentImageTarget === 'project') {
          showProjectImagePreview(image.url);
        }
        closeImageSelector();
      }
    }

    function showImagePreview(url, alt) {
      document.getElementById('featuredImagePreview').style.display = 'block';
      document.getElementById('previewImage').src = url;
      document.getElementById('imageUrl').textContent = url;
      document.getElementById('imageAlt').value = alt;
    }

    function removeFeaturedImage() {
      document.getElementById('featuredImagePreview').style.display = 'none';
      document.getElementById('previewImage').src = '';
      document.getElementById('imageUrl').textContent = '';
      document.getElementById('imageAlt').value = '';
    }

    function savePost() {
      const form = document.getElementById('postForm');
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const postData = {
        id: document.getElementById('postId').value || Date.now().toString(),
        title: document.getElementById('postTitle').value,
        slug: document.getElementById('postSlug').value,
        category: document.getElementById('postCategory').value,
        excerpt: document.getElementById('postExcerpt').value,
        content: document.getElementById('postContent').value,
        featuredImage: document.getElementById('previewImage').src || '',
        imageAlt: document.getElementById('imageAlt').value,
        metaTitle: document.getElementById('metaTitle').value,
        metaDescription: document.getElementById('metaDescription').value,
        author: document.getElementById('postAuthor').value,
        status: document.getElementById('postStatus').value,
        date: new Date().toISOString().split('T')[0],
        readTime: Math.ceil(document.getElementById('postContent').value.split(' ').length / 200)
      };

      if (document.getElementById('postId').value) {
        blogCMS.updatePost(postData);
      } else {
        blogCMS.createPost(postData);
      }

      closePostModal();
    }

    function editPost(postId) {
      openPostModal(postId);
    }

    function deletePost(postId) {
      if (confirm('هل أنت متأكد من حذف هذا المقال؟')) {
        blogCMS.deletePost(postId);
      }
    }

    // === SERVICE FUNCTIONS ===
    function openServiceModal(serviceId = null) {
      const modal = document.getElementById('serviceModal');
      const form = document.getElementById('serviceForm');
      form.reset();

      if (serviceId) {
        const service = blogCMS.services.find(s => s.id === serviceId);
        if (service) {
          document.getElementById('serviceModalTitle').textContent = 'تعديل الخدمة';
          document.getElementById('serviceId').value = service.id;
          document.getElementById('serviceName').value = service.name;
          document.getElementById('serviceSlug').value = service.slug;
          document.getElementById('serviceIcon').value = service.icon;
          document.getElementById('serviceDescription').value = service.description;
          document.getElementById('serviceContent').value = service.content;

          if (service.featuredImage) {
            showServiceImagePreview(service.featuredImage);
          }
        }
      } else {
        document.getElementById('serviceModalTitle').textContent = 'إضافة خدمة جديدة';
        document.getElementById('serviceFeaturedImagePreview').style.display = 'none';
      }

      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeServiceModal() {
      const modal = document.getElementById('serviceModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }

    function openImageSelectorForService() {
      currentImageTarget = 'service';
      openImageSelector();
    }

    function showServiceImagePreview(url) {
      document.getElementById('serviceFeaturedImagePreview').style.display = 'block';
      document.getElementById('servicePreviewImage').src = url;
    }

    function removeServiceFeaturedImage() {
      document.getElementById('serviceFeaturedImagePreview').style.display = 'none';
      document.getElementById('servicePreviewImage').src = '';
    }

    function saveService() {
      const form = document.getElementById('serviceForm');
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const serviceData = {
        id: document.getElementById('serviceId').value || Date.now().toString(),
        name: document.getElementById('serviceName').value,
        slug: document.getElementById('serviceSlug').value,
        icon: document.getElementById('serviceIcon').value,
        description: document.getElementById('serviceDescription').value,
        content: document.getElementById('serviceContent').value,
        featuredImage: document.getElementById('servicePreviewImage').src || ''
      };

      if (document.getElementById('serviceId').value) {
        blogCMS.updateService(serviceData);
      } else {
        blogCMS.createService(serviceData);
      }

      closeServiceModal();
    }

    function editService(serviceId) {
      openServiceModal(serviceId);
    }

    function deleteService(serviceId) {
      if (confirm('هل أنت متأكد من حذف هذه الخدمة؟')) {
        blogCMS.deleteService(serviceId);
      }
    }

    // === PROJECT FUNCTIONS ===
    function openProjectModal(projectId = null) {
      const modal = document.getElementById('projectModal');
      const form = document.getElementById('projectForm');
      form.reset();

      if (projectId) {
        const project = blogCMS.projects.find(p => p.id === projectId);
        if (project) {
          document.getElementById('projectModalTitle').textContent = 'تعديل المشروع';
          document.getElementById('projectId').value = project.id;
          document.getElementById('projectTitle').value = project.title;
          document.getElementById('projectSlug').value = project.slug;
          document.getElementById('projectCategory').value = project.category;
          document.getElementById('projectDescription').value = project.description;
          document.getElementById('projectClient').value = project.client || '';
          document.getElementById('projectDate').value = project.date;
          document.getElementById('projectDuration').value = project.duration || '';
          document.getElementById('projectTags').value = project.tags ? project.tags.join(', ') : '';
          document.getElementById('projectContent').value = project.content || '';
          document.getElementById('projectFeatures').value = project.features ? project.features.join('\n') : '';

          if (project.image) {
            showProjectImagePreview(project.image);
          }
        }
      } else {
        document.getElementById('projectModalTitle').textContent = 'إضافة مشروع جديد';
        document.getElementById('projectFeaturedImagePreview').style.display = 'none';
        // Set default date to today
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('projectDate').value = today;
      }

      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeProjectModal() {
      const modal = document.getElementById('projectModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }

    function openImageSelectorForProject() {
      currentImageTarget = 'project';
      openImageSelector();
    }

    function showProjectImagePreview(url) {
      document.getElementById('projectFeaturedImagePreview').style.display = 'block';
      document.getElementById('projectPreviewImage').src = url;
    }

    function removeProjectFeaturedImage() {
      document.getElementById('projectFeaturedImagePreview').style.display = 'none';
      document.getElementById('projectPreviewImage').src = '';
    }

    function saveProject() {
      const form = document.getElementById('projectForm');
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Parse tags
      const tagsInput = document.getElementById('projectTags').value;
      const tags = tagsInput ? tagsInput.split(',').map(t => t.trim()).filter(t => t) : [];

      // Parse features
      const featuresInput = document.getElementById('projectFeatures').value;
      const features = featuresInput ? featuresInput.split('\n').map(f => f.trim()).filter(f => f) : [];

      const projectData = {
        id: document.getElementById('projectId').value || Date.now().toString(),
        title: document.getElementById('projectTitle').value,
        slug: document.getElementById('projectSlug').value,
        category: document.getElementById('projectCategory').value,
        description: document.getElementById('projectDescription').value,
        client: document.getElementById('projectClient').value,
        date: document.getElementById('projectDate').value,
        duration: document.getElementById('projectDuration').value,
        tags: tags,
        image: document.getElementById('projectPreviewImage').src || '',
        content: document.getElementById('projectContent').value,
        features: features
      };

      if (document.getElementById('projectId').value) {
        blogCMS.updateProject(projectData);
      } else {
        blogCMS.createProject(projectData);
      }

      closeProjectModal();
    }

    function editProject(projectId) {
      openProjectModal(projectId);
    }

    function deleteProject(projectId) {
      if (confirm('هل أنت متأكد من حذف هذا المشروع؟')) {
        blogCMS.deleteProject(projectId);
      }
    }

    // === MEDIA FUNCTIONS ===
    function deleteMedia(mediaId) {
      if (confirm('هل أنت متأكد من حذف هذه الصورة؟')) {
        blogCMS.deleteMedia(mediaId);
      }
    }

    function updateImageAlt(imageId, alt) {
      blogCMS.updateImageAlt(imageId, alt);
    }
  </script>
</body>
</html>
